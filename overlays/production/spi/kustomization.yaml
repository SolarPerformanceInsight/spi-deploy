apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
commonLabels:
  state: prod
namespace: production
resources:
- ../../../base/spi
- ingress.yaml
- migration-job.yaml
images:
- digest: sha256:4d25664ec677f88a1d57d623c4bd88883b78ce863ef5ddd3d30b6f6b8d10f72c
  name: quay.io/solarperformanceinsight/solarperformanceinsight

patchesJson6902:
- patch: |-
    - op: replace
      path: /spec/template/spec/containers/0/env/0/value
      value: "spi-mysql.production.svc"
  target:
    group: batch
    kind: Job
    name: schema-migration
    version: v1
- patch: |-
    - op: replace
      path: /spec/template/spec/containers/0/env/0/value
      value: "spi-mysql.production.svc"
  target:
    group: apps
    kind: Deployment
    name: solarperformanceinsight
    version: v1
- patch: |-
    - op: replace
      path: /spec/template/spec/containers/0/env/1/value
      value: "spi-redis.production.svc"
  target:
    group: apps
    kind: Deployment
    name: solarperformanceinsight
    version: v1
- patch: |-
    - op: replace
      path: /spec/template/spec/containers/0/env/0/value
      value: "spi-mysql.production.svc"
  target:
    group: apps
    kind: Deployment
    name: spi-rq-worker
    version: v1
- patch: |-
    - op: replace
      path: /spec/template/spec/containers/0/env/1/value
      value: "spi-redis.production.svc"
  target:
    group: apps
    kind: Deployment
    name: spi-rq-worker
    version: v1
- patch: |-
    - op: replace
      path: /spec/template/spec/containers/0/env/0/value
      value: "spi-mysql.production.svc"
  target:
    group: apps
    kind: Deployment
    name: spi-queue-sync
    version: v1
- patch: |-
    - op: replace
      path: /spec/template/spec/containers/0/env/1/value
      value: "spi-redis.production.svc"
  target:
    group: apps
    kind: Deployment
    name: spi-queue-sync
    version: v1
